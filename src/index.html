<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet"
      href="https://unpkg.com/bootstrap@3.3.7/dist/css/bootstrap.min.css">
    <title>Angular QuickStart</title>
    <base href="/">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href = "/">

    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="/manifest.json">

    <!-- Polyfill(s) for older browsers -->
    <script src="node_modules/core-js/client/shim.min.js"></script>

    <script src="node_modules/zone.js/dist/zone.js"></script>
    <script src="node_modules/systemjs/dist/system.src.js"></script>
    <script src="systemjs.config.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-messaging.js"></script>
    <!-- <script src="firebase-messaging-sw.js"></script> -->

    <!-- <script src="src/main.js"></script> -->
    <script >
      System.import('main.js').catch(function(err){ console.error(err); });
    </script>
    <script>
      var config = {
        apiKey: "AIzaSyDs83fCGsYjdZULGj3N7mnXRlBSUIo7Rsw",
        authDomain: "pwatest-89869.firebaseapp.com",
        databaseURL: "https://pwatest-89869.firebaseio.com",
        projectId: "pwatest-89869",
        storageBucket: "pwatest-89869.appspot.com",
        messagingSenderId: "1043250904569"
      };
      firebase.initializeApp(config);
      var messaging = firebase.messaging();
       messaging
         .requestPermission()
         .then(function () {
           // MsgElem.innerHTML = "Notification permission granted."
           console.log("Notification permission granted.");
           // get the token in the form of promise
           console.log(messaging.getToken());
           return messaging.getToken()
         })
         .then(function(token) {
           // print the token on the HTML page
           // TokenElem.innerHTML = "token is : " + token;
           console.log("Token is "+token);
         })
         .catch(function (err) {
         // ErrElem.innerHTML = ErrElem.innerHTML + "; " + err
         console.log("Unable to get permission to notify.", err);
       });
       messaging.onMessage(function(payload){
         console.log(payload);
       });
      //  messaging.setBackgroundMessageHandler(function (payload) {
      //   console.log('Handling background message ', payload);
      //
      //   return self.registration.showNotification(payload.data.title, {
      //     body: payload.data.body,
      //     icon: payload.data.icon,
      //     tag: payload.data.tag,
      //     data: payload.data.link
      //   });
      // });

        // }

    </script>

  </head>

  <body>
    <button ng-click="fap()">send message</button>
    <my-app>Loading AppComponent content here ...</my-app>
  </body>
</html>
